# System Design для социальной сети для путешественников. Поток 13

## Функциональные требование

- Возможность публиковать посты с прикреплением фотографий, текста с описанием
  - Просмотр собственной ленты
- Возможность ставить гео метки на посты
- Лента с публикациями от отслеживаемых путешественников
  - Записи в обратном хронологическом порядке
- Система оценки и комментариев для постов
- Система поиска постов по геометкам
- Система рекомендаций популярный мест по запросу

## Нефункциональные требования

- DAU 10.000.000 (первый год, дальше линейный рост)
- Аудитория СНГ
- Высокая надежность системы:
  - Доступность в год около 99.999%
  - Данные клиентов не могут теряться/повреждаться (необходимо иметь бэкапы, реплики данных, надежную доставку)
- Для пользователя должен грузиться быстро (из требований удобства):
  - Подгрузка контента в ленте + комменты (в размере экрана, но не более 10) не более ~300 ms (с учетом хорошего интернета)
  - Регистрация лайков на пост мгновенная
  - Публикация комментов мгновенная
  - Отображение новых комментов под постом не более 2с с момента публикации
  - Поиск по геометкам не более 1с
  - Загрузка контента пользователем (1 пост) на сервера (с учетом хорошего интернета) в рамках до ~1 мин
  - После загрузки контента пользователем, подписчики должны увидеть пост в ленте не позже ~10с (собственную публикацию не более 1с)
- Публикации не удаляются со временем из хранилища
- Платформы: web, ios, android
- Учет популярных аккаунтов (тех у кого много подписчиков)
- Сезонность: Весна, лето
- Типы активностей:
  - нет ограничений на кол-во просмотров постов в ленте (get запросы), возьмем в среднем 50 (?)
  - ожидается в среднем, 10 публикаций в сутки от пользователя (1 пост = 1 медиа файл + небольшой текст)
  - лайки, комментарии ~ кол-ву просмотренных публикаций
- Есть возможность сжимать фото

## Расчет примерной нагрузки

- Публикация
  - RPS = 10.000.000 * 10 / 86.400 ~ 1157
  - Traffic (media) = 1154 * 1mb (avg_image_size) = 1154mb  ~1.154.000kb ~ 1gb/s
  - Traffic (text) = 1154 * 100kb (avg_text_size) = 115.400kb ~ 115 mb/s
  - Traffic (geo mark/other meta) = 1157 * 5kb = 5600kb ~ 5,6mb/s

- Просмотр ленты
  - RPS = 10.000.000 * 50 / 86.400 ~ 5787
  - Traffic (media) = 5787 * 1mb (avg_image_size) = 5787mb ~ 5.787.000kb ~ 5gb/s
  - Traffic (text) = 5787 * 100kb (avg_text_size) = 578.700kb ~ 578мb/s
  - Traffic (reactions) (тк в требованиях нет реации на комменты , то считаем только на посты в медиане) =
  5787 * 500b = 2600000b ~ 2,6 mb/s
  - Traffic (meta data) = 5787 * 50kb = 260000kb ~ 260mb/s

Connections = 10.000.000 * 0.1 = 1.000.000
